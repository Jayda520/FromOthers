<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Emoji Social Attention (Web)</title>

  <link rel="stylesheet" href="./lib/jspsych.css">

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: rgb(128,128,128) !important;
      overflow: hidden;
    }

    /* ✅ 强制显示鼠标 */
    body, body * { cursor: default !important; }
    input, textarea { cursor: text !important; }
    button, select, option, label, a { cursor: pointer !important; }

    /* jsPsych 全屏兜底 */
    #jspsych-target,
    .jspsych-display-element,
    .jspsych-content-wrapper,
    .jspsych-content {
      width: 100vw !important;
      height: 100vh !important;
      max-width: none !important;
      max-height: none !important;
      margin: 0 !important;
      padding: 0 !important;
      box-sizing: border-box !important;
    }

    .jspsych-display-element,
    .jspsych-content-wrapper,
    .jspsych-content {
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }

    .fit-fullscreen-img {
      width: 100vw;
      height: 100vh;
      object-fit: contain;
      display: block;
    }
  </style>

  <!-- ✅✅ V2 诊断面板：挂在 html 根节点上，且自动“复活”，不会被 experiment.js 删掉 -->
  <script>
    (function(){
      const PANEL_ID = "__BOOT_PANEL_V2__";
      const VERSION = "BOOT_PANEL_V2 2026-02-04";

      function ensurePanel(){
        let panel = document.getElementById(PANEL_ID);
        if (!panel){
          panel = document.createElement("div");
          panel.id = PANEL_ID;
          panel.style.cssText = [
            "position:fixed",
            "left:16px",
            "top:16px",
            "width:min(980px, calc(100vw - 32px))",
            "background:rgba(255,255,255,0.96)",
            "border-radius:14px",
            "padding:14px 16px",
            "font-family:Consolas, Menlo, monospace",
            "font-size:14px",
            "line-height:1.45",
            "color:#111",
            "box-shadow:0 10px 30px rgba(0,0,0,.25)",
            "z-index:2147483647"
          ].join(";");
          panel.innerHTML = `
            <div style="font-weight:800;font-size:15px;margin-bottom:6px;">${VERSION}</div>
            <div id="__BOOT_LOG__" style="white-space:pre-wrap;"></div>
            <div style="margin-top:10px;border-top:1px solid #ddd;padding-top:10px;font-size:12px;color:#444;">
              你现在看到这个面板 = 说明这个 index.html 已经生效。<br/>
              如果你看不到它：说明 Pages 仍在用旧文件/改错目录/缓存没刷新。
            </div>
          `;
          // 挂到 html 根节点，防止 body 被清空时一起没了
          document.documentElement.appendChild(panel);
        }
        return panel;
